# Parametric CAD Kernel

An open-source parametric CAD system written in Rust, targeting browser deployment via WebAssembly.

## Rendered Output

Generated by tessellating B-Rep solids and projecting to SVG with painter's algorithm shading.

<table>
<tr>
<td><img src="docs/renders/box.svg" alt="Box" width="400"/></td>
<td><img src="docs/renders/cylinder.svg" alt="Cylinder" width="400"/></td>
</tr>
<tr>
<td><img src="docs/renders/sphere.svg" alt="Sphere" width="400"/></td>
<td><img src="docs/renders/extrude_l.svg" alt="Extruded L-Profile" width="400"/></td>
</tr>
<tr>
<td colspan="2" align="center"><img src="docs/renders/revolve_vase.svg" alt="Revolved Vase" width="400"/></td>
</tr>
</table>

To regenerate: `cargo run -p cad-render`

## Architecture

```
crates/
  kernel/        - B-Rep topology, geometry, Boolean ops, operations
  tessellation/  - Triangle mesh generation from B-Rep solids
  solver/        - 2D constraint solver (Gauss-Newton + Levenberg-Marquardt)
  wasm-bridge/   - WebAssembly API wrapping the kernel
  render/        - SVG render generation (dev tool)
```

## Key Features

**Geometry Engine**
- Points, vectors, transforms, bounding boxes
- Curves: lines, circles, ellipses, NURBS
- Surfaces: planes, cylinders, cones, spheres, tori, NURBS
- Ray intersection: plane, sphere, cylinder, AABB, line-line

**B-Rep Topology**
- Half-edge data structure with SlotMap arena allocation
- Euler-Poincare validation (V - E + F = 2)
- Topology auditing (closed loops, twin consistency)

**Solid Operations**
- Primitives: box, cylinder, sphere
- Extrude: arbitrary 2D profiles along a direction
- Revolve: profiles around an arbitrary axis (lathe)
- Boolean: union, intersection, difference (AABB grid decomposition for overlapping boxes)

**Constraint Solver**
- 13 constraint types: coincident, distance, angle, parallel, perpendicular, horizontal, vertical, tangent, symmetric, equal, radius, fixed, point-on-entity
- Gauss-Newton with Levenberg-Marquardt damping
- Analytic Jacobians for quadratic convergence

**Tessellation**
- Fan triangulation of planar faces
- UV grid sampling for parametric surfaces
- f32 output for WebGL compatibility

## Building

```bash
cargo build --workspace
cargo test --workspace     # 109 tests
cargo run -p cad-render    # generate SVG renders
```

## Tests

109 tests across 4 crates:
- **78** kernel (topology, geometry, boolean, operations, validation)
- **10** property-based (proptest)
- **15** solver (constraint types, linear system, multi-constraint sketches)
- **2** tessellation
- **4** wasm-bridge
